---
title: "BIOS 611 Project Report"
author: "Carson Mowrer"
date: "2025-11-22"
output: pdf_document
---

# Introduction
Since 2015, Major League Baseball (MLB) has equipped every stadium with a combination of high-speed cameras and Doppler radar systems, collectively known as Statcast, to track the trajectory and characteristics of every pitch and batted ball. Statcast captures a remarkably rich set of measurements, providing teams and analysts with precise, pitch-by-pitch and swing-by-swing data throughout the entire season. For each pitch, Statcast records variables such as release velocity, spin rate, spin axis, horizontal and vertical movement, pitch location when it crosses home plate, pitch type, and the names of the pitcher and batter. For every batted ball, it reports exit velocity, launch angle, projected distance, landing location, and the resulting play outcome (e.g. single, double, home run, out).

This dataset has transformed player evaluation and strategy in modern baseball and also provides a rich environment for exploratory analysis and statistical modeling. In this project, I focus on two complimentary goals: (1) characterizing the structure of the pitch and batter performance data, and (2) developing a predictive framework to address data sparsity in specific batter-pitcher matchups. 

## Aim 1: Characterizing Pitch Types and Batter Performance Profiles

The first component of the project seeks to understand how different pitch types relate to one another and how pitchers’ arsenals cluster in high-dimensional space. Pitch labels, such as “four seam fastball”, “slider”, or “curveball”, are widely used but often inconsistently applied across teams, automated systems, and even pitchers themselves. To explore the underlying structure of pitch characteristics, I apply t-distributed Stochastic Neighbor Embedding (t-SNE) to project high-dimensional pitch features into two dimensions for visualization. I complement this with principal component analysis (PCA) to identify the linear combinations of features explaining the greatest variation in the data. 

To move beyond purely visual groupings, I also fit a Gaussian Mixture Model (GMM) to identify clusters of pitches with similar physical characteristics, and evaluate how well these clusters align with Statcast pitch labels. The resulting interactive visualization displays each pitch in the reduced t-SNE space, colored by cluster membership, with tooltips linking each point to the pitch type, pitcher, and relevant metrics. A parallel workflow examines batter performance against different pitch types, enabling the identification of clusters of batters with similar skill profiles or tendencies when facing certain pitches.

## Aim 2: Predicting Batter-Pitcher Outcomes Under Data Sparsity

The second aim addresses a practical challenge: individual batter-pitcher matchups are often too sparse to support reliable predictions. Even in a full 162-game season, many players face each other only a handful of times, fall too few plate appearances to estimate how a batter is likely to perform against a particular pitch from a particular pitcher.

To overcome this limitation, I take inspiration from the Synthetic Estimated Average Matchup methodology developed by Julia Wapner, David Dalpiaz, and Daniel Eck^1^, and build an application that augments the observed data for a given batter-pitcher-pitch-type combination with information from similar players. The intuition is that similar pitchers, who throw pitches with comparable velocity, movement, and spin, provide additional examples of how the batter performs against that style of pitch. Similar batters, who produce similar outcomes against the pitch type, also provide additional information about how the pitcher’s pitch performs against a comparable population. By combining actual observations from the selected batter-pitcher matchup with augmented observations from similar pitchers and batters, the application estimated the distribution of exit velocity and launch angle for balls put into play. Because these two variables strongly predict offensive outcomes, the tool also reports an expected batting average on balls in play and the expected number of bases a batter is likely to record on balls in play. 

# Aim 1

## Pitch Structures

The first objective of the project was to understand the structure and natural clusterings of pitch types using MLB Statcast data from the 2025 season. To do this, I began by identifying the set of quantitative measurements available for each pitch. These included (1) release velocity (mph), (2) spin rate (rpm), (3) spin axis in the X–Z plane, measured in degrees, where 180° represents pure backspin and 0° pure topspin, (4) induced horizontal and vertical movement, and (5) the horizontal (x) and vertical (z) location of the pitch as it crossed home plate. Collectively, these variables describe both the physical characteristics of each pitch and the location and shape of its trajectory. For each pitcher and pitch type, I computed the average of each measurement over the 2025 season and standardized all features to place them on a comparable scale. After removing observations I classified as “non-pitches,” including pitch-outs and ambiguous “other” events, this process resulted in 3,719 unique pitcher–pitch combinations drawn from 710,084 total pitches thrown during the season.

To explore the dominant sources of variation in these measurements, I first applied principal component analysis (PCA). This method identifies linear combinations of the pitch variables that account for the largest proportions of total variance. While PCA loadings can be challenging to interpret in general, in this case the first two principal components provided somewhat interpretable summaries of meaningful differences between pitch types. The first component (PC1), which accounted for approximately 40% of total variation, had negative loadings for release speed, spin axis, vertical movement, and vertical location, and positive loadings for spin rate, horizontal movement, and horizontal location. A high value of this component therefore corresponds to a pitch that is relatively slow, thrown with high spin, exhibits more horizontal than vertical movement, and is located low and away from a right-handed batter. A pitch matching this profile corresponds well to the modern sweeper. In contrast, the second component (PC2), which explained an additional ~24% of variation, was dominated by a positive loading on spin axis and negative loadings on most other features. A pitch such as a four-seam fastball thrown high and inside to a right-handed hitter would receive a strongly negative value on PC2. Together, the first two components explained approximately 64% of the variation in pitch characteristics and can be interpreted as describing a spectrum ranging from slower, high-movement pitches to faster pitches with more direct trajectories. 

![Biplot of PCA for Pitch Profiles](figures/pca_biplot_pitches.png){width=75%}

A biplot of the first two principal components illustrates how different pitch types cluster in this lower-dimensional space. Pitches of similar type group together in distinct regions, and the directions of the variable vectors indicate how individual features contribute to the components. For example, release velocity and induced horizontal movement point roughly in the same direction, indicating that these features tend to increase together, while vertical and horizontal movement vectors point in nearly orthogonal directions, highlighting that variation in one does not reliably predict variation in the other. The PCA results both align with baseball intuition and illustrate that measurable physical properties effectively differentiate pitches even without using pitch-type labels.
Motivated by the clear separation of pitch types in PCA space and the apparent existence of coherent “phenotypes” of pitches, I next sought to formally cluster the data. I applied a Gaussian mixture model (GMM), which assumes that the observed data arise from a mixture of multivariate normal distributions, with each component corresponding to a latent pitch group. Each pitch is then assigned to the cluster for which it has the highest posterior probability. To select the appropriate number of clusters, I fit models with varying numbers of components and used the Bayesian Information Criterion (BIC) to determine the best balance of goodness-of-fit and model complexity. The selected model contained nine clusters, suggesting that MLB pitch types can be parsimoniously represented using roughly nine generative groups based solely on their physical characteristics.

To visualize these clusters in two dimensions, I used t-distributed stochastic neighbor embedding (t-SNE), which projects high-dimensional observations onto a lower-dimensional space while preserving local distances and neighborhood structure as closely as possible. The resulting t-SNE plot displays distinct groups of points that correspond closely with the clusters identified by the GMM, with each point colored according to its assigned cluster. A static version of this figure is shown in the report, and an interactive version with hover-based pitch details is included in the project files. 

![t-SNE Proejctions and GMM Clustering of Pitches](figures/tsne_clusters_static_pitches.png){width=75%}

Using Statcast pitch labels and baseball domain knowledge, I characterized the nine GMM clusters as follows:

* Cluster 1 (red): Right-handed cutters and hard sliders
* Cluster 2 (orange): Left-handed four-seam fastballs and right-handed cutters
* Cluster 3 (yellow-green): Right-handed four-seam fastballs
* Cluster 4 (green): Left-handed sinkers and changeups
* Cluster 5 (blue-green): Left-handed curveballs, sliders, and sweepers
* Cluster 6 (light blue): Right-handed curveballs, sweepers, and slower sliders
* Cluster 7 (blue): Right-handed changeups and split-finger pitches
* Cluster 8 (purple): Atypical pitches, including unusually slow pitches from position players and pitches on the boundaries of other types
* Cluster 9 (pink): Right-handed sinkers

One noticeable feature of the clustering is the consistent separation between pitches thrown by left- and right-handed pitchers. Although not initially obvious, this makes sense given that pitches such as curveballs and sliders move in opposite directions depending on the pitcher’s handedness, resulting in mirrored but distinct clusters. The main exception is Cluster 2, which groups together left-handed four-seam fastballs and right-handed cutters. These pitches share nearly identical speed and movement profiles when viewed from the catcher’s perspective, and therefore become difficult to distinguish without considering pitcher handedness directly. 

The t-SNE visualization also reveals an example of a continuous spectrum of pitch behavior, moving from harder pitches with minimal break (e.g., cutters) to progressively slower pitches with greater movement (e.g., sliders, sweepers, and curveballs). In the embedding, this progression forms a roughly linear band near y = 0, and while t-SNE does not produce affine subspace projections, the ordering is consistent with canonical distinctions in baseball pitch design. The visualization also makes it easy to highlight outliers and pitches that deviate from expected cluster behavior. For example, the two outlying points between Clusters 1 and 4 correspond to (1) the unusually slow left-handed sinker thrown by Tom Cosgrove of the Chicago Cubs, and (2) a faster, straighter-moving sweeper thrown by Cam Schlittler of the New York Yankees. These examples illustrate how the clustering framework can identify individual pitches that behave unusually relative to the broader population.

## Batter Structures

To complement the analysis of pitch characteristics, I also sought to investigate the structure of batter performance profiles when facing different pitch types. The goal was to determine whether hitters tend to exhibit consistent profiles across all pitch types—reflecting stable skill or approach—or whether their outcomes are more strongly dependent on the type of pitch they face. To characterize this, I used several Statcast-derived measures: average exit velocity and launch angle for balls put in play, their respective standard deviations, the rate at which batters swung at pitches outside the strike zone (chase rate), and the rate at which they swung and missed altogether (whiff rate). Together, these variables describe both quality of contact and plate discipline.

As with the pitches, I summarized data for each batter and pitch type by computing means and standard deviations for each feature and standardizing the resulting values. I then performed principal component analysis to identify dominant patterns of variation across batter–pitch combinations. The first principal component (PC1) included negative loadings for mean exit velocity and mean launch angle, and positive loadings for the standard deviations of both exit velocity and launch angle, as well as chase rate and whiff rate. Hitters with high PC1 scores therefore tended to hit weaker contact—often resulting in ground balls—while also exhibiting higher variability in batted ball outcomes and elevated chase and swing-and-miss rates. In other words, this component captures the contrast between consistent, high-quality contact and more erratic offensive performance.

The second principal component (PC2) showed positive contributions from mean and standard deviation of launch angle and from the standard deviation of exit velocity, and negative contributions from mean exit velocity, chase rate, and whiff rate. A hitter with a low value on PC2 would therefore chase and miss more frequently but still produce higher exit velocities, albeit with greater variability in launch angle. Together, the first two components accounted for approximately 52% of total variation in the dataset, indicating that the primary dimensions of batter performance reflect a combination of contact quality, consistency of contact, and plate discipline. 

![Biplot of PCA for Batter Profiles](figures/pca_biplot_batters.png){width=75%}

A biplot of the projections onto the first two components, colored by the type of pitch each profile was recorded against, reveals substantially less separation by pitch type than was observed in the pitch-level analysis. Most points lie in a single central cluster, suggesting that batter performance characteristics are less directly tied to the specific pitch thrown. However, subtle patterns still emerge. For example, plate appearances against four-seam fastballs (shown in red circles) tend to fall more often on the left side of the plot, while performances against split-finger pitches (pink diamonds with a cross) tend to occupy the right side. The arrows representing variable loadings reinforce earlier interpretations: chase rate and whiff rate contribute in similar directions, while mean exit velocity is nearly orthogonal to these, indicative of largely independent sources of variation.

To provide a complementary visualization, I applied t-SNE to produce a two-dimensional representation that more directly preserves pairwise distances in the full feature space. The resulting plot, colored again by pitch type, shows mild but visually identifiable tendencies. Plate appearances against four-seam fastballs cluster more densely near the top of the projection, while sinker outcomes are disproportionately represented on the right. These patterns demonstrate that even though variability across batters likely dominates the space, pitch type still contributes structure to some extent. 

![t-SNE Proejctions and GMM Clustering of Batter Profiles](figures/tsne_clusters_static_batters.png){width=75%}

To more formally examine patterns in batter performance, I applied a Gaussian mixture model to the full standardized data and selected a seven-cluster solution based on the Bayesian Information Criterion. A static visualization is included in the report, and an interactive version is available in the project files. While the clusters are less sharply defined than in the pitch analysis, some meaningful tendencies emerge. Points assigned to Clusters 6 and 2, located near the upper and right portions of the t-SNE embedding and consisting largely of performance against four-seam fastballs and sinkers, correspond to batters with higher exit velocities and lower whiff rates, indicating more effective contact. In contrast, Clusters 1, 3, and 4, typically associated with off-speed pitches such as curveballs and changeups, include profiles characterized by higher whiff rates and greater variability in launch angle and exit velocity, reflecting less consistent quality of contact. “Static batter clusters”
These findings suggest that while pitch characteristics play a role, most of the variance in batting outcomes is driven by batter-specific traits—such as contact ability, plate discipline, and batted-ball consistency—rather than by the specific pitch type being faced. In contrast to the pitch-level analysis, where discrete pitch types formed clearly separable groups, batter performance appears to lie along broader, continuous dimensions reflecting underlying skill and approach.

# Aim 2

The second aim of this project extends the insights gained from the analyses in Aim 1. As shown in the earlier visualizations, most pitches thrown in Major League Baseball have several close counterparts: other pitches with highly similar velocity, spin, movement, and typical location. Likewise, batters facing a particular type of pitch often have statistical “nearest neighbors” with comparable tendencies and outcomes. This observation suggests a natural strategy for estimating outcomes in situations where direct matchup information is sparse, such as predicting the distribution of launch angles and exit velocities produced by a specific batter when facing a specific pitcher and pitch type. Many of these precise batter–pitcher–pitch combinations are observed only a handful of times per season, and some never occur at all. If we assume that similar batters or similar pitches produce similar outcomes, information borrowed from these neighbors can stabilize and improve distributional estimation.
This methodology is inspired by the Synthetic Estimated Average Matchup framework introduced by Wapner et al^1^., which estimates where a ball is likely to be hit when a particular batter faces a particular pitcher. Here, however, the focus is more granular, and I restrict attention to individual pitches thrown by individual pitchers and aim to estimate the joint distribution of launch angle and exit velocity, rather than batted-ball location.

The first step in the approach is identifying nearest neighbors for both pitches and batters. Using the standardized feature profiles generated in Aim 1, I applied a k-nearest neighbors algorithm to locate the 50 most similar observations for each batter–pitch combination based on Euclidean distance in the feature space. Then, for any matchup of interest, I queried the full season’s data to extract (i) all observed batted balls from the true batter–pitcher–pitch matchup, (ii) batted balls involving the same batter but a similar pitch/pitcher, and (iii) batted balls involving the same pitch/pitcher but a similar batter.

For each of these three categories, I constructed empirical joint distributions of launch angle and exit velocity using discretized bins of 10 degrees and 10 miles per hour. Each observation was then weighted to reflect the similarity to the true matchup of interest. True observed matchup data received a weight of 1. Observations from neighboring batters or pitchers received weights between 0 and 1, determined by an exponential decay function applied to the Euclidean distance from the original matchup so that more similar comparisons have a greater weight.

These three weighted distributions were then combined into a single synthetic distribution. To prevent the neighbor-derived data from overwhelming the relatively sparse true observations, I scaled each distribution by the square root of the total weight of its contributing observations. While this method improves stability, the resulting estimate may still appear blocky, particularly for relief pitchers or batters who played less than a full season. To account for this, I applied Gaussian kernel smoothing to obtain a continuous, more realistic joint distribution estimate.

To make this approach accessible and interactive, I developed a Shiny application that allows users to select a batter, pitcher, and pitch type. The application then computes and displays the synthetic distribution of launch angle and exit velocity for the selected matchup and includes additional contextual information: the relative contributions of true, batter-neighbor, and pitch-neighbor observations; the most similar batters and pitchers involved in the construction; and an autofill-enabled selector that filters available pitch types once a pitcher is chosen.

Because launch angle and exit velocity are strongly predictive of batted-ball success, I extended the synthetic distribution framework to estimate two practical outcome metrics for the matchup: expected batting average on balls in play (BABIP) and the expected number of bases on contact, where singles through home runs are assigned values of one through four and outs zero. Using league-wide data, I computed the average hit probability and expected number of bases within each 10° × 10 mph cell. Multiplying these outcome tables by the synthetic joint distribution and summing over all cells produced estimated matchup-level BABIP and expected bases values, which are displayed alongside the distribution visualization in the Shiny app. 

![Example Synthetic Matchup, Aaron Judge vs Tarik Skubal, 4-Seam Fastball](shiny_app_example.png){width=75%}

An example output illustrates the utility of the tool: a matchup between Aaron Judge, the 2025 American League MVP, and Tarik Skubal, the 2025 AL Cy Young Award winner, facing a 4-seam fastball. The resulting synthetic distribution shows dense concentration around 110–120 mph and 20–30°, representing barreled contact, and a secondary cluster near 80–90 mph and –30 to –40°, representing weakly hit balls. The nearest neighbors contributing to the estimate include Corey Seager, Nick Kurtz, and Jordan Beck on the batting side, and Blake Snell, McKenzie Gore, and Aroldis Chapman on the pitching side. Approximately 16% of the weighted estimate derives from direct Judge–Skubal data, 43% from Judge against similar pitchers, and 41% from Skubal against similar batters. The final estimate suggests that a batted 4-seam fastball from Skubal results in Judge reaching base safely roughly 35% of the time, with an expected 0.816 bases per ball in play.

The application also supports estimation for matchups that have never occurred, although these estimates naturally carry greater uncertainty. It even allows exploration of theoretical or impossible scenarios including, for example, two-way player Shohei Ohtani facing himself as both the pitcher and batter.

# Conclusions

This project proved successful in describing and clustering the physical characteristics of pitches across Major League Baseball, as well as the performance patterns of batters when confronting those pitches. Beyond the exploratory findings, the work also produced a practical tool that could be valuable to analysts and decision-makers, enabling more informed matchup-level predictions even when direct historical data are sparse. That said, there remain several opportunities to improve and refine the methodology. One straightforward path would be to expand the modeling framework to incorporate multiple seasons of data. Doing so would strengthen estimation in cases where certain matchups occur infrequently, although the additional volume of data would also increase computational demands and complexity.

During the development of the model, one variable emerged as particularly challenging: the pitch spin axis. Because this variable lies on a circular scale from 0 to 360 degrees, working with it as a linear measurement can produce misleading results. For instance, two pitches with spin axes of 350 degrees and 10 degrees are mathematically far apart when treated linearly, yet in reality they represent very similar physical behavior. Addressing the cyclicity appropriately, such as through a circular distance metric, would likely improve similarity estimation and nearest-neighbor selection.

Another natural extension of the model concerns the way expected outcomes are calculated. The current framework estimates batting average on balls in play and bases gained using league-wide outcomes, but the likelihood of a result also depends strongly on the ballpark. Because every MLB stadium has different fence distances, wall heights, and field dimensions, a ball hit at a particular speed and angle may be a home run in one park and a routine flyout in another. Incorporating park effects would therefore enable outcome projections that are not only more realistic, but more strategically useful. Similarly, environmental conditions, such as temperature, humidity, and air density, meaningfully affect how far batted balls travel. Adjusting for these factors could further refine model accuracy.

Finally, an interesting methodological question remains around the influence of pitcher handedness. In the current layout, pitches with the same classification (for example, curveballs or changeups) often appear in different clusters depending on whether they are thrown by right- or left-handed pitchers. In the context of outcome prediction, this separation is desirable, since batters frequently perform differently against pitches with similar labels but different handedness. However, it would be insightful to explore a transformation that accounts for handedness, such as mirroring the horizontal movement and spin axis, so that pitches could be compared on purely physical characteristics. Such a comparison would reveal whether handedness differences truly create distinct pitch “types,” or whether pitches with the same name converge into a single shared cluster once the coordinate system is aligned.

# References

^1^ https://seam.stat.illinois.edu/
